    # Let's Encrypt
    # https://letsencrypt.org/getting-started/
    # https://www.digitalocean.com/community/tutorials/how-to-secure-nginx-with-let-s-encrypt-on-ubuntu-14-04
    # https://community.letsencrypt.org/t/howto-a-with-all-100-s-on-ssl-labs-test-using-apache2-4-read-warnings/2436

    # Getting an A+ on Qualy's SSL Labs Tester
    # https://sethvargo.com/getting-an-a-plus-on-qualys-ssl-labs-tester/

    server {
        listen         80;
        server_name    xxxxx.meteorapp.space;
        return         302 https://xxxxx.meteorapp.space;
        access_log off;
    }
    server {
        listen          443 ssl spdy;
        server_name     xxxxx.meteorapp.space;
        
        
        # Standard SSL
        # https://www.digitalocean.com/community/tutorials/how-to-install-an-ssl-certificate-from-a-commercial-certificate-authority
        # https://www.namecheap.com/support/knowledgebase/article.aspx/467/67/how-do-i-generate-a-csr-code
        ssl on;
        ssl_certificate /deploy/ssl/a-plus.crt;
        ssl_certificate_key /deploy/ssl/a-plus.key;
        
        # Enable OCSP Stapling, point to certificate chain
        ssl_stapling on;
        ssl_stapling_verify on;
        ssl_trusted_certificate /deploy/ssl/a-plus.ca-bundle;
        #resolver 8.8.8.8 8.8.4.4 [2001:4860:4860::8888] [2001:4860:4860::8844];
        resolver 8.8.8.8 8.8.4.4 208.67.222.222 208.67.220.220 [2001:4860:4860::8888] [2001:4860:4860::8844] valid=300s;
        resolver_timeout 10s;
        
        # enable session resumption to improve https performance
        ssl_session_cache shared:SSL:10m;
        ssl_session_timeout 10m;
        
        # make the server choose the best cipher instead of the browser
        # enables server-side protection from BEAST attacks
        ssl_prefer_server_ciphers on;
        
        # disable SSLv3(enabled by default since nginx 0.8.19) since it's less secure then TLS http://en.wikipedia.org/wiki/Secure_Sockets_Layer#SSL_3.0
        # ssl_protocols TLSv1.1 TLSv1.2;
        ssl_protocols TLSv1.2;
        
        # support only believed secure ciphersuites using the following priority:
        # 1.) prefer PFS enabled ciphers
        # 2.) prefer AES128 over AES256 for speed (AES128 has completely adequate security for now)
        # 3.) Support DES3 for IE8 support
        #
        # disable the following ciphersuites completely
        # 1.) null ciphers
        # 2.) ciphers with low security
        # 3.) fixed ECDH cipher (does not allow for PFS)
        # 4.) known vulnerable cypers (MD5, RC4, etc)
        # 5.) little-used ciphers (Camellia, Seed)
        # 6.) < 256 bit ciphers
        ssl_ciphers 'ECDHE-RSA-AES256-GCM-SHA384 ECDHE-ECDSA-AES256-GCM-SHA384 ECDHE-RSA-AES256-SHA384 ECDHE-ECDSA-AES256-SHA384 ECDHE-RSA-AES256-SHA ECDHE-ECDSA-AES256-SHA DHE-RSA-AES256-GCM-SHA384 DHE-RSA-AES256-GCM-SHA DHE-RSA-AES256-SHA256 DHE-RSA-AES256-SHA !aNULL !eNULL !LOW !kECDH !3DES !MD5 !EXP !PSK !SRP !DSS !CAMELLIA !SEED';

        # Diffie-Hellman parameter for DHE ciphersuites, recommended 2048 bits
        # https://raymii.org/s/tutorials/Strong_SSL_Security_On_nginx.html#Forward_Secrecy_&_Diffie_Hellman_Ephemeral_Parameters
        ssl_dhparam /deploy/ssl/dhparam-4096.pem;
                        
        # config to enable HSTS(HTTP Strict Transport Security)
        # https://developer.mozilla.org/en-US/docs/Security/HTTP_Strict_Transport_Security
        # to avoid ssl stripping https://en.wikipedia.org/wiki/SSL_stripping#SSL_stripping
        # add_header Strict-Transport-Security 'max-age=31536000';
        add_header Strict-Transport-Security 'max-age=31536000; includeSubDomains; preload;';

        location ~ /.well-known {
            allow all;
        }
    }






    server {
        listen         80;
        server_name    xxxxx.meteorapp.space;
        return         302 https://xxxxx.meteorapp.space;
        access_log off;
    }
    server {
        listen          443 ssl spdy;
        server_name     xxxxx.meteorapp.space;
        
        ssl on;
        ssl_certificate /etc/letsencrypt/live/meteorapp.space/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/meteorapp.space/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/meteorapp.space/fullchain.pem;
        ssl_dhparam /etc/letsencrypt/live/meteorapp.space/dhparam-4096.pem;

        ssl_stapling on;
        ssl_stapling_verify on;
        resolver 8.8.8.8 8.8.4.4 208.67.222.222 208.67.220.220 [2001:4860:4860::8888] [2001:4860:4860::8844] valid=300s;
        resolver_timeout 10s;
        ssl_session_cache shared:SSL:10m;
        ssl_session_timeout 10m;
        ssl_prefer_server_ciphers on;
        ssl_protocols TLSv1.2;
        ssl_ciphers 'ECDHE-RSA-AES256-GCM-SHA384 ECDHE-ECDSA-AES256-GCM-SHA384 ECDHE-RSA-AES256-SHA384 ECDHE-ECDSA-AES256-SHA384 ECDHE-RSA-AES256-SHA ECDHE-ECDSA-AES256-SHA DHE-RSA-AES256-GCM-SHA384 DHE-RSA-AES256-GCM-SHA DHE-RSA-AES256-SHA256 DHE-RSA-AES256-SHA !aNULL !eNULL !LOW !kECDH !3DES !MD5 !EXP !PSK !SRP !DSS !CAMELLIA !SEED';
        add_header Strict-Transport-Security 'max-age=31536000; includeSubDomains; preload;';

        location ~ /.well-known {
            allow all;
        }
    }
